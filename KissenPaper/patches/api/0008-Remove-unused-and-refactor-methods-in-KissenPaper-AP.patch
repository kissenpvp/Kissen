From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Groldi <chniucg@gmail.com>
Date: Tue, 15 Aug 2023 19:13:03 +0200
Subject: [PATCH] Remove unused and refactor methods in KissenPaper API

Removed unused KissenPaperBan.java and improved code clarity across multiple files including:

1. Refactored method names to improve clarity and maintain naming convention. For example, from getCommandExecutor() to obtainCommandExecutor().
2. Reduce optional usage by nullability annotations.
3. Added backend exception handling in ServerLoginPacketListener to avoid failed login due to backend issues.
4. Remove redundant permissions checks and replaced some with a more efficient solution.
5. Introduced consolidating if block for better readability.

These changes are intended to improve the readability of the codebase and maintain a coherent code structure, facilitating easier maintenance in the future.

diff --git a/src/main/java/net/kissenpvp/paper/api/ban/PaperBanImplementation.java b/src/main/java/net/kissenpvp/paper/api/ban/PaperBanImplementation.java
index 99e68450c9ccbe4059cfe1c626530a96d2e37fe0..27539701fb0071e4751e9c47f449145579e2dc5c 100644
--- a/src/main/java/net/kissenpvp/paper/api/ban/PaperBanImplementation.java
+++ b/src/main/java/net/kissenpvp/paper/api/ban/PaperBanImplementation.java
@@ -18,7 +18,6 @@ package net.kissenpvp.paper.api.ban;
 
 import net.kissenpvp.core.api.ban.*;
 import net.kissenpvp.core.api.database.meta.BackendException;
-import net.kissenpvp.core.api.networking.client.entitiy.PlayerClient;
 import net.kissenpvp.paper.api.base.Context;
 import net.kyori.adventure.text.Component;
 import org.jetbrains.annotations.NotNull;
@@ -36,9 +35,9 @@ public interface PaperBanImplementation extends BanImplementation<PaperBan, Pape
 
     @NotNull @Unmodifiable Set<PaperPunishment> getPlayerBanSet(@NotNull UUID totalID, @NotNull Context context) throws BackendException;
 
-    @NotNull Optional<@Nullable PaperPunishment> getCurrentBan(@NotNull UUID totalID, Context context) throws BackendException;
+    @NotNull Optional<PaperPunishment> getCurrentBan(@NotNull UUID totalID, Context context) throws BackendException;
 
-    @NotNull Optional<@Nullable PaperPunishment> getCurrentBan(@NotNull UUID totalID, @NotNull BanType banType, Context context) throws BackendException;
+    @NotNull Optional<PaperPunishment> getCurrentBan(@NotNull UUID totalID, @NotNull BanType banType, Context context) throws BackendException;
 
-    @NotNull PaperPunishment ban(@NotNull UUID totalID, @NotNull PaperBan ban, @NotNull BanOperator banOperator, @Nullable Component reason, @NotNull Context context) throws BackendException;
+    @NotNull PaperPunishment punish(@NotNull UUID totalID, @NotNull PaperBan ban, @NotNull BanOperator banOperator, @Nullable Component reason, @NotNull Context context) throws BackendException;
 }
diff --git a/src/main/java/net/kissenpvp/paper/api/networking/client/entity/PaperPlayerClient.java b/src/main/java/net/kissenpvp/paper/api/networking/client/entity/PaperPlayerClient.java
index f9aa3613e48904202cd3b2a15d8f45b9f5a4b282..c3fc78944bc8e28791d4a2c2844474d245d533e0 100644
--- a/src/main/java/net/kissenpvp/paper/api/networking/client/entity/PaperPlayerClient.java
+++ b/src/main/java/net/kissenpvp/paper/api/networking/client/entity/PaperPlayerClient.java
@@ -39,16 +39,16 @@ import java.util.Optional;
 import java.util.Set;
 
 
-public interface PaperPlayerClient extends PlayerClient<PaperPermission, PaperPlayerRank, PaperPunishment>, Permissible, PaperGroubablePermissionEntry {
+public interface PaperPlayerClient extends PlayerClient<PaperPermission, PaperPlayerRank, PaperPunishment>, PaperGroubablePermissionEntry {
 
     @NotNull @Unmodifiable Set<@NotNull PaperOnlinePlayerClient> getOnlineAltAccounts();
 
     @NotNull Set<Suffix> getSuffixSet(@NotNull Context context);
 
-    @NotNull Optional<@Nullable Suffix> getSuffix(@NotNull String name, @NotNull Context context);
+    @NotNull Optional<Suffix> getSuffix(@NotNull String name, @NotNull Context context);
 
     @NotNull
-    Optional<@Nullable Suffix> setSuffix(@NotNull String name, @NotNull Component content, Context context);
+    Optional<Suffix> setSuffix(@NotNull String name, @NotNull Component content, Context context);
 
     boolean deleteSuffix(@NotNull String name, @NotNull Context context);
 
diff --git a/src/main/java/net/kissenpvp/paper/api/permission/PaperPermissionEntry.java b/src/main/java/net/kissenpvp/paper/api/permission/PaperPermissionEntry.java
index 3aad2f9711323caa9953cd1157de529ed05cb6aa..a05f47271949fcc46881fa52bd7b5b4cf4f426e0 100644
--- a/src/main/java/net/kissenpvp/paper/api/permission/PaperPermissionEntry.java
+++ b/src/main/java/net/kissenpvp/paper/api/permission/PaperPermissionEntry.java
@@ -38,7 +38,7 @@ public interface PaperPermissionEntry extends PermissionEntry<PaperPermission>,
 
     @NotNull @Unmodifiable Set<PaperPermission> getPermissionList(@NotNull Context context);
 
-    @NotNull Optional<@Nullable PaperPermission> getPermission(@NotNull String permission, @NotNull Context context);
+    @NotNull Optional<PaperPermission> getPermission(@NotNull String permission, @NotNull Context context);
 
     boolean hasPermission(@NotNull String permission, @NotNull Context context);
 }
diff --git a/src/main/java/org/bukkit/event/player/PlayerLoginEvent.java b/src/main/java/org/bukkit/event/player/PlayerLoginEvent.java
index 62fb782baad5c80a3daaa557c0faa674c58a98cf..3725bad41fd5357425824548503a0112c0798748 100644
--- a/src/main/java/org/bukkit/event/player/PlayerLoginEvent.java
+++ b/src/main/java/org/bukkit/event/player/PlayerLoginEvent.java
@@ -247,6 +247,7 @@ public class PlayerLoginEvent extends PlayerEvent {
         /**
          * The player is not allowed to log in, for reasons undefined
          */
-        KICK_OTHER
+        KICK_OTHER,
+        BACKEND_EXCEPTION// KissenPaper
     }
 }
